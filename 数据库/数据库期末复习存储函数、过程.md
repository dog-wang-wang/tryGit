# 1.触发器

1.关键词：

trigger

2.作用：

当发生某个事件之后执行某些行为，当定义了了处罚程序之后数据库执行某些语句的时候就相当于事件发生了会自动触发执行语句

3.语法

```sql
delimiter $
create trigger 触发器名
{after/ before} {insert,delete,update} on 表名 for each row 
begin
	要执行的语句;
end $
delimiter ;
```

4.例子

```sql
create table ft(id int primary key auto_increment,name varchar(20));
create table st(options varchar(50),content varchar(30));
delimiter $
create trigger log_trigger
after insert on ft for each row
begin 
insert into st(options,content) values(concat(now(),"  [begin:insert]"),new.name);
end $
delimiter ;

```

5.例子中的new

```sql
new ：insert或者update后的新记录
old ：delete或者update后的旧记录
```

6.查看某个数据库中的触发器

| 语句                                                         | 作用                         |
| ------------------------------------------------------------ | ---------------------------- |
| show triggers from 数据库名                                  | 查询数据库里所有触发器       |
| show create trigger 数据库名.触发器名                        | 查询数据库里某个触发器的定义 |
| select * from information_schema.triggers  where trigger_schema = ’表名‘; | 查询某个触发器               |

7.删除触发器

drop [if exisits] trigger 触发器名

# 2.变量

## 1.分类：

​	1.系统变量：用户和会话变量的区别在于作用域
​		全局变量(global):只针对于当权数据库实例，重启mysql服务之后就失效了
​		会话变量(session):会话变量在某个绘画当中发生了变化之后不会影响其他会话

​	2.用户自定义变量
​		会话变量：可以自己定义出来一些会话变量别的会话不受影响
​		局部变量：只可以在存储函数和存储过程中使用的变量

## 2.系统变量

​	1.查看系统变量

| 方式                                                  | 作用                                                         |
| ----------------------------------------------------- | ------------------------------------------------------------ |
| show [global/session] variables                       | 查看某种系统变量（默认session）                              |
| show [global/session] variables like '模糊匹配字符串' | 查看某些特征名字的系统变量                                   |
| select @@[global./session.] 系统变量名                | 查询某个指定名字的系统变量（默认会话变量理查没有了才去全局） |

​	2.修改系统变量

```sql
方式一：
	set @@global/@@session .系统变量名=值;
方式二：
	set global 系统变量名 = 值
```

## 3.用户变量

​	1.会话变量

​		1.定义并赋值用户会话变量

​			set @变量名=值

​			select 字段名 into @变量名 from ...(要保证查询出来的值是一个结果)

​		2.查看某个用户会话变量

​			select  @变量名

​		3.查看所有用户变量

​			select * from performance_schema.user_variables_by_thread;

​	2.局部变量

​		1.声明方式：

​			declare 变量名 类型 [default 默认值]
​			局部变量的声明要放在begin和end之间的最前面的行

​		2、赋值：
​			方式1：
​				set 变量名=值;
​				set 变量名:=值;
​			方式2：
​				select 字段名或表达式 into 变量名 from 表;

​		3.查看

​			select 变量名

## 4.综述

​	1.查询的时候都是select 

​		系统变量用@@[分类类型.]来区分
​		用户会话用@

​	2.修改的时候都是set

​		系统变量用@@[分类类型.]来区分
​		用户会话用@	
​		但是系统变量可以直接set 分类类型 变量名

# 3.存储过程与存储函数

