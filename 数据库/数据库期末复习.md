---
期末数据库复习
---

## 1.create和drop

### 1.可以用来创建数据库、表、索引、用户、视图、存储过程、存储函数

```sql
create 要创建的东西 名字 配置
1.数据库
	create database [if not exists] 数据库名 [character set ‘字符集’]
2.表
	create table [if not exists] 表名 (字段名称 字段类型，字段名称 字段类型)
	create table [if not exists] 表名 as 查询语句
3.视图
	create view 视图名 as 查询语句
	要在建立视图的时候就进行字段名的更改就直接在查询的时候使用as在查询语句中进行更改就可以
4.索引
	create table [if not exists] 表名 [(字段名称 字段类型 [列级约束]，字段名称 字段类型,index 索引名 索引字段，[表级约束])]
5.存储过程存储函数
	create procedure / function 名字()
6.用户
	create user '用户名' identified [@可访问主机ip地址] by '密码'
7.触发器
	create [if not exists] trigger 触发器名
```

### 2.可以删除创建数据库、视图、表、索引

```sql
1.语法
	drop 操作对象类型 [if exists] 操作对象名字
2.操作实例
	drop database [if exists] 数据库名
	drop table [if exists]表名
	drop view [if exists] 视图名 
	drop procedure/ function 名字
	drop [if exists] trigger 触发器名
```

## 2.alter和update

​	1.修改配置

```sql
1.作用:修改配置
2.语法：
	alter 操作对象类型 操作对象名字 操作
3.操作实例
	3.1数据库修改
	alter database 数据库名 character set ‘字符集’
	3.2表修改
		3.2.1对列进行修改：
	修改列名:alter table 表名 change column 原列名 新列名 列类型
	添加新列:alter table 表名 add column 新字段 字段类型
	删除某列:alter table 表名 drop column 字段名
	删除主键:alter table 表名 drop primary key
	删除索引:alter table 表名 drop index 索引名
	添加主键:alter table 表名 add primary key(字段名) 
	添加索引:alter table 表名 add index 索引名 索引表名(索引字段)
	添加表级约束:alter table 表名 add constraint 约束类型 约束名 约束类型(约束字段)
	修改列级约束:alter table 表名 modify 字段名 约束类型（这种方式也可以用来直接修改not null成为null）
	修改某列类型:alter table 表名 modify 字段名 新类型 [default 默认数据] 
	修改某个表名:alter table 表名 rename to 新表名 
	
```

​	2.修改数据

```sql
1.作用：修改数据
2.语法:update 表名/ set 字段名=字段值[,字段名=字段值,字段名=字段值...] where 查询条件
3.操作实例：
	修改某些元组的某个字段值
		update 表名 set 某字段名=新字段值 where 查询条件
	修改某些元组的多个字段值
		update 表名 set 某字段名=新字段值，某字段名=新字段值 where 查询条件

```

## 3.insert和delete

### 	1.可以用来插入数据

```sql
1.insert into 表名[(字段1,字段2)] values (字段1值,字段2值)[,(字段值1，字段值2....)....];
2.insert into 表名[(字段1,字段2)] select语句   要保证查询语句的结果和字段一一对应
```

### 	2.可以用来删除数据

```sql
1.作用：删除元组
2.语法：delete from 表名 where 条件
3.注：没有where会删除表中的所有记录
```

## 6.rename

 rename table 旧表名 to 新表名

## 7.知识点性质的

### 	7.1约束：

```sql
我个人感觉上主键约束和唯一性约束就是个索引，不是纯粹意义的约束，所以我喜欢这么记
​	not null：限定字段不为空，一个表可以有多个不为空的字段，在定义的时候只能单个列非空的定义，不能联合约束

​	unique(对于联合约束，必须约束的是整体，对部分没有限制)：限制某字段不重复，一个表可以有多个约束，可以有联合约束，创建约束的时候如果不命名就默认是字段名，
		唯一约束在创建的时候会创建唯一性索引，索引名和约束名一样，删除的时候只能通过删除索引的方式删除约束
​	primary key：相当于唯一性约束和非空约束的综合，如果是联合的约束，那么作为主键的每一个字段都不可以是空的，组合的值不可以重复，也会创建主键索引，可以通过删除主键约束的方式删除主键索引，主键名固定，就是primary,想改都不能改
​	foreign key：先创建主表在创建从表
	外键约束等级:cascade|set null| no action|restrict
		cascade:主表update/delete 记录时子表同步对应的记录
		set null:主表update/delete 记录时子表对应记录置为null
		no action:如果子表中有匹配的记录，则不允许对父表对应候选键进行 update/delete 操作
		restrict:和no action一样
​	check约束
		检查某个字段的值是否符号xx要求，一般指的是值的范围
		语法：check(值域要求)	
			
```



#### 		7.1.1约束有两种：列级约束，表级约束,

​			外键要求必须是主表的主键而且有外键的时候必须要求先创建主表在创建从表，先给主表添加数据再给从表添加数据

#### 		7.1.2约束添加方式有两种

```sql
对于外键约束：
constraint foreign key(字段1，字段2...) 外键约束名 references 主表名(主表字段1，主表字段2...) [on 约束等级] 
```

​			1.建表的时候添加：

```sql
列级约束：在字段值后面加上约束的修饰符
​表级约束：把约束当成一个单独的字段看待，在原有字段的最后添加约束字段
	语法:create table 表名(字段1，字段2，constraint 约束名 约束类型（约束字段）)
	eg:create table tb_pk2(id int ,salary decimal(10, 2),constraint primary key(id));		
```

​			2.建表后修改：

```sql
列级约束：使用alter table 表名  modify 字段名 约束类型
​表级约束：使用alter table 表名 add constraint 字段名 约束类型
```

#### 	7.1.3删除约束的方式依据约束类型来定

​		7.1.3.1：not null

```sql
	只需要修改约束类型成为null就行
	alter table 表名 modify 列名 null
```

​		7.1.3.2：unique

```sql
	删除unique所约束字段的唯一性索引就行
	alter table 表名 drop index 索引名
```

​			复合约束如果不指定，那么名字就是复合约束的第一个属性的属性名

​		7.1.3.3：primary key

​			一个表最多一个主键约束

​			主键约束名字就是主键名

```sql
alter table 表名 drop primary key
```

​		7.1.3.4：foreign key

​			先删除约束，再删除外键对应的普通索引

```sql
alter table 表名 drop foreign key 外键约束名
alter table 表名 drop index 外键约束名
```

### 	7.2view

#### 		7.2.1文字

​			视图是一种虚拟的表，本身不具有数据，占有的内存非常少，作用就是让某些人只能操作表中的一部分数据，而不能对每个字段的值都进行操作

​			如果要对于基表(产生view时查询的表)进行更改或删除，那么视图里的数据也会相应变化，反着也是，但是对于及表中没有的数据，就算视图进行了修改也不会同步到基表：例如avg函数计算出来的值，像是这种计算出来的值就不可以进行同步

​			如果直接删除视图不会使得视图对应的及表中的数据直接消失

#### 		7.2.1语法

​	创建：create view  [if not exists] 视图名 as 查询语句

​	修改视图的列：alter view 视图名 as 查询语句

​	修改视图里的内容：update 视图名 set 字段名=字段值 where 条件

​	删除：drop view  [if exists] 视图名

8.杂：

| 操作                                                  | 作用                                                         |
| ----------------------------------------------------- | ------------------------------------------------------------ |
| show databases                                        | 查看数据库                                                   |
| use 数据库名                                          | 使用数据库                                                   |
| show tables                                           | 查看表                                                       |
| show variables like 'character_%'                     | 查看使用的编码方式                                           |
| select database()                                     | 查看现在正在使用哪个数据库                                   |
| desc 表名                                             | 显示表的信息                                                 |
| truncate 表名                                         | 删除表内数据                                                 |
| show tables from 数据库名                             | 查看某个数据库里的表                                         |
| show trigger from 数据库名                            | 查看某数据库里的所有触发器                                   |
| show create trigger from 数据库名.触发器名            | 查看某数据库里某个触发器                                     |
| show [global/session] variables                       | 查看某种系统变量（默认session）                              |
| show [global/session] variables like '模糊匹配字符串' | 查看某些特征名字的系统变量                                   |
| select @@[global./session.] 系统变量名                | 查询某个指定名字的系统变量（默认会话变量理查没有了才去全局） |
|                                                       |                                                              |
|                                                       |                                                              |
|                                                       |                                                              |

